//===========================
// 大陀螺（Gyro Fastmode）单文件版
// 只需 exec 本文件即可独立启用
// 如需自定义转速，请修改 yaw 数值
//===========================

// 主入口（可绑定此指令实现一键开关）
alias cMot_gyro_fastmode_on  "cMot_gyro_fast_0;alias cMot_gyro_fast_tryloop cMot_gyro_fast_0;alias cMot_gyro_fastmode cMot_gyro_fastmode_off"
alias cMot_gyro_fastmode_off "alias cMot_gyro_fast_tryloop alias cMotTicker_9ms_gyro;alias cMot_gyro_fastmode cMot_gyro_fastmode_on"
alias cMot_gyro_fastmode cMot_gyro_fastmode_on

// 递归主循环链（核心逻辑）
alias cMot_gyro_fast_0 "alias cMotTicker_9ms_gyro cMot_gyro_fast_1"
alias cMot_gyro_fast_1 "alias cMotTicker_9ms_gyro cMot_gyro_fast_5"
alias cMot_gyro_fast_2 "alias cMotTicker_9ms_gyro cMot_gyro_fast_3"
alias cMot_gyro_fast_3 "alias cMotTicker_9ms_gyro cMot_gyro_fast_4"
alias cMot_gyro_fast_4 "alias cMotTicker_9ms_gyro cMot_gyro_fast_5"
alias cMot_gyro_fast_5 "cMot_gyro_fast_chk1;alias cMotTicker_9ms_gyro cMot_gyro_fast_6"
alias cMot_gyro_fast_6 "cMot_rev_forceoff_ticked;alias cMotTicker_9ms_gyro cMot_gyro_fast_tryloop"

// 检查与递归终点
alias cMot_gyro_fast_chk1 cMot_gyro_ticked
alias cMot_gyro_ticked "cMot_gyro_angle;cMot_rev_ticked;alias cMotTicker_9ms_gyro"

// 旋转数值（请根据你的灵敏度和 m_yaw 修改）
alias cMot_gyro_angle yaw 3272.727272 1 1 // 11688.311688 = 180/(sens*m_yaw)

// 反转链（用于切换方向/终止）
alias cMot_rev_ticked cMot_rev_off
alias cMot_rev_off "alias cMot_gyro_r cMot_fmv_r;alias cMot_gyro_l cMot_fmv_l;alias cMot_gyro_f cMot_fmv_f;alias cMot_gyro_b cMot_fmv_b;cMot_rel_rl_upd;cMot_rel_fb_upd;alias cMot_rev_ticked cMot_rev_on;alias cMot_rev_forceoff_ticked alias cMotTicker_9ms_gyro"
alias cMot_rev_on  "alias cMot_gyro_r cMot_fmv_l;alias cMot_gyro_l cMot_fmv_r;alias cMot_gyro_f cMot_fmv_b;alias cMot_gyro_b cMot_fmv_f;cMot_rel_rl_upd;cMot_rel_fb_upd;alias cMot_rev_ticked cMot_rev_off;alias cMot_rev_forceoff_ticked cMot_gyro_ticked"
alias cMot_rev_forceoff_ticked cMot_gyro_ticked

// 方向更新（保持兼容性）
alias cMot_rel_rl_upd cMot_mv_rl
alias cMot_rel_fb_upd cMot_mv_fb

// 方向移动（RL/FB）
alias cMot_mv_rl "cMot_fmv_rl;alias cMot_rel_rl_upd cMot_mv_rl"
alias cMot_mv_fb "cMot_fmv_fb;alias cMot_rel_fb_upd cMot_mv_fb"

// 方向执行（RL/FB）
alias cMot_fmv_r  "right -999 0 0;left -999 0 0;+right     ;"
alias cMot_fmv_l  "right -999 0 0;left -999 0 0;+left      ;"
alias cMot_fmv_fb "forward -999 0 0;back -999 0 0;           "
alias cMot_fmv_rl "right -999 0 0;left -999 0 0;           "
alias cMot_fmv_f  "forward -999 0 0;back -999 0 0;+forward   "
alias cMot_fmv_b  "forward -999 0 0;back -999 0 0;+back      ;"

//===========================
// 使用说明：
// 1. exec 本文件
// 2. bind "key" cMot_gyro_fastmode // 绑定任意键一键开关
// 3. 如需自定义转速，修改 yaw 数值
//===========================
exec Horizon/src/core/ticker/init
bind "/" cMot_gyro_fastmode
